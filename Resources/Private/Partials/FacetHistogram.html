{namespace s=Tx_SolrFrontend_ViewHelpers}

<div class="histogram" id="c-{uid}-histogram-{facetName}">
	<script type="text/javascript">
		(function () {
			var histogramConfiguration = {
				'fieldName': <s:json data="{facetInfo.field}"/>,
				'barWidth': {f:if(condition:facetInfo.barWidth, then:facetInfo.barWidth else:1)},
				'linkTemplate': <s:json data='<f:uri.action addQueryString="TRUE" arguments="{s:facetLinkArguments(facetName:facetName, itemName:\"%%%%\", mode:\"add\", activeFacets:activeFacets)}" argumentsToBeExcludedFromQueryString="{s:facetLinkArguments(facetName:facetName, mode:\"remove\", activeFacets:activeFacets)}"/>'/>,
				'activeFacets': [],
			}
			<f:for each="{activeFacets}" as="activeFacet">
				<f:if condition="{0:activeFacet.name} == {0:facetInfo.field}">
					histogramConfiguration.activeFacets.push("{activeFacet.value}");
				</f:if>
			</f:for>
			var facetData = <s:json data="{facetData.values}"/>;

			solr_frontend.createHistogramForTermsInContainer(facetData, document.getElementById('c-{uid}-histogram-{facetName}'), histogramConfiguration);
		})();
	</script>
</div>

<f:if condition="{s:facetIsActive(facetName:facetName, activeFacets:activeFacets, type:'range')}">
	<f:for each="{activeFacets}" as="activeFacet">
		<f:if condition="{0:activeFacet.name} == {0:facetInfo.field}">
			<f:link.action
				addQueryString="TRUE"
				argumentsToBeExcludedFromQueryString="{s:facetLinkArguments(facetName:facetName, activeFacets:activeFacets, mode:'remove', type:'range')}"
				class="facetRemove">
				<s:regexp string="<f:format.printf arguments='{0:activeFacet.value}'><f:translate key='remove filter %s'/></f:format.printf>"
							match="/\[([0-9]*) TO ([0-9]*)\]/" replace="\1-\2"/>
			</f:link.action>
		</f:if>
	</f:for>
</f:if>
