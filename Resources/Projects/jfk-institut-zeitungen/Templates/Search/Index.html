{namespace s=Tx_Find_ViewHelpers}
<f:layout name="Default"/>

<f:section name="main">
<f:debug>{_all}</f:debug>
	<s:pageTitle>
		<f:render partial="Components/QueryString" arguments="{query:arguments.q, facets:activeFacets}"/>
		â€“
		{pageTitle}
	</s:pageTitle>
	<f:render partial="Page/Standard" arguments="{_all}"/>

	<div class="results">
		<div class="navigation top"/>
			<f:render partial="Components/ResultCount" arguments="{_all}"/>
			<f:render partial="Components/Pagination" arguments="{_all}"/>
		</div>

		<section class="facets-buchstabe">
			<style type="text/css">.facetCount {display: none;}</style>
			<f:render partial="Facets/Facet"
					  arguments="{
						  facetData: '{s:valueForKey(array:results.components.facetset.facets, key:facets.10.id)}',
						  facetInfo: facets.10,
						  activeFacets: activeFacets
			}"/>
		</section>

		<ol id="c{uid}-resultList" class="resultList" start="{counterStart}">
			<script type="text/javascript">
				var ZDBInformation = function (data) {
					var container;

					var electronicInfos = ZDBInfoElement( jQuery('ElectronicData', data) );
					var printInfos = ZDBInfoElement( jQuery('PrintData', data) );

					if (electronicInfos || printInfos) {
						container = document.createElement('div');
						if (ZDBUseClientIP) {
							appendLibraryNameFromResultDataTo(data, container);
						}
					}

					if (electronicInfos) {
						var electronicHeading = document.createElement('h5');
						container.appendChild(electronicHeading);
						electronicHeading.appendChild(document.createTextNode(localise('elektronisch')));
						container.appendChild(electronicInfos);
					}

					if (printInfos) {
						var printHeading = document.createElement('h5');
						container.appendChild(printHeading);
						printHeading.appendChild(document.createTextNode(localise('gedruckt')));
						container.appendChild(printInfos);
					}

					return container;
				};


			</script>

			<f:for each="{results.documents}" as="document">
				<li>
					<p class="itemHeader">
						<s:regexp match="/&lt;&lt;([^<>]*)&gt;&gt;/" replace="\1">
							<f:render partial="Display/Field/Inline" arguments="{results:results, document:document, field:'title', separator:', '}"/>
							<f:render partial="Display/Field/Inline" arguments="{results:results, document:document, field:'publisher', separator:', '}"/>
						</s:regexp>

						<f:if condition="document.fields.identifier">
							<f:link.external uri="http://aleph-www.ub.fu-berlin.de/F/?func=find-c&ccl_term=idn={document.fields.identifier.0}" class="catalogueLink" target="fu-opac">zum Katalog</f:link.external>
						</f:if>
					</p>
					<f:if condition="{document.fields.issn}">
						<script type="text/javascript">
							var JOPURL = '/zdb/full.xml?issn={document.fields.issn.0}&genre=journal';
							jQuery.get(JOPURL, function (data) {
								console.log(data);
								var jData = jQuery(data);
								console.log(ZDBInformation(data));
							});
						</script>
							{document.fields.issn.0}
						</p>
					</f:if>
				</li>
			</f:for>
		</ol>

		<div class="navigation bottom"/>
			<f:render partial="Components/Pagination" arguments="{_all}"/>
		</div>
	</div>
</f:section>
